<script>
  const savedTheme = localStorage.getItem("theme");
  const savedSet = localStorage.getItem("themeSet");
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

  const initialTheme = savedTheme || (prefersDark ? "dark" : "light");
  const initialSet = savedSet || "rose";

  document.documentElement.setAttribute("data-theme", initialTheme);
  document.documentElement.setAttribute("data-theme-set", initialSet);

  // Ensure updated values are written to localStorage if not present
  if (!savedTheme) {
    localStorage.setItem("theme", initialTheme);
  }
  if (!savedSet) {
    localStorage.setItem("themeSet", initialSet);
  }
</script>